# ============================================================
# AgentGEO Unified Optimization Configuration File
# ============================================================
#
# This configuration file supports three optimization methods:
# 1. AutoGEO - The baseline method from the paper
# 2. AgentGEO - Our autonomous agent method
# 3. Baseline - 9 optimization methods from GEO-Bench
#
# ============================================================

# Optimization method selection
optimizer:
  method: "agentgeo"  # Options: autogeo, agentgeo, baseline, all

# ============================================================
# AutoGEO Configuration (baseline method from the paper)
# ============================================================
autogeo:
  dataset_name: "GEO-Bench"
  engine_llm: "claude-haiku-4-5-20251001"
  rule_path: null

# ============================================================
# AgentGEO Configuration (our agent-based optimization method)
# ============================================================
agentgeo:
  # Module configuration file path (contains LLM, search engine, HTML parser configurations)
  config_path: "geo_agent/config.yaml"

  # Batch processing configuration
  batch_size: 10           # Batch size
  max_concurrency: 4       # Maximum concurrency

  # ============================================================
  # Citation Checking Method (V2.2 new feature)
  # ============================================================
  # Options: "llm", "attr_evaluator", "both"
  #
  # - llm: Use LLM to check citations (default, fastest)
  #   Use case: Rapid prototyping, large-scale batch processing
  #   Speed: Fast | Accuracy: Medium
  #
  # - attr_evaluator: Use Attribute Evaluator to check citations
  #   Use case: Production environment (recommended)
  #   Speed: Medium | Accuracy: High
  #
  # - both: Use both methods (composite mode)
  #   Use case: When highest accuracy or recall is needed
  #   Speed: Slow | Accuracy: Highest
  citation_method: "llm"

  # ============================================================
  # Composite Mode Strategy (only effective when citation_method="both")
  # ============================================================
  # Options: "any", "all", "llm_primary", "attr_primary"
  #
  # - any: Citation detected if either method finds it
  #   Use case: Maximize recall
  #
  # - all: Citation detected only if both methods agree
  #   Use case: Maximize precision (strictest)
  #
  # - llm_primary: LLM result is primary, attr_evaluator as auxiliary
  #   Use case: Balance speed and accuracy
  #
  # - attr_primary: attr_evaluator result is primary, LLM as auxiliary
  #   Use case: Prioritize accuracy
  citation_composite_strategy: "any"

  # Attribute Evaluator configuration file path (required when using attr_evaluator)
  # If null, use default configuration
  attr_evaluator_config: null

  # Whether to use fast mode for Attribute Evaluator
  # true: Fast mode (suitable for large-scale batch processing)
  # false: Full mode (more accurate but slower)
  use_fast_mode: true

  # ============================================================
  # Performance Comparison Reference
  # ============================================================
  #
  # Method                     | Speed  | Accuracy | Use Case
  # ---------------------------|--------|----------|------------------
  # llm                        | Fast   | Medium   | Rapid prototyping, batch processing
  # attr_evaluator (fast)      | Medium | High     | Production (recommended)
  # attr_evaluator (full)      | Slow   | Highest  | High quality requirements, small batch
  # both (any)                 | Slow   | High     | Maximize recall
  # both (all)                 | Slow   | Highest  | Maximize precision
  # both (attr_primary)        | Slow   | Highest  | Prioritize accuracy
  # both (llm_primary)         | Medium | Medium   | Balance speed and accuracy
  #
  # ============================================================

  # Other configurations
  enable_memory: true                      # Enable memory feature
  enable_history: true                     # Enable history logging
  chunks_per_orchestra: 2                  # Number of document chunks per orchestration
  suggestion_merge_strategy: "diagnosis_aware"  # Suggestion merge strategy

  # Tool configuration (V2.4 new feature)
  # Whether to enable autogeo_rephrase tool (AutoGEO paper method)
  enable_autogeo_rephrase: true

# GEO-Bench Baseline Configuration (9 optimization methods)
baseline:
  provider: "openai"
  model: "gpt-4.1-mini"
  methods: null  # null = all 9 methods, or specify ["cite_sources", "authoritative"]

# Data configuration
data:
  input_type: "parquet"
  input_path: "data/test_data.parquet"
  required_fields:
    - raw_html
    - train_queries
    - test_queries

# Output configuration
output:
  base_dir: "outputs"
  save_optimized_html: true
  save_evaluation: true

# Evaluation configuration (optional)
# When enable_citation=true, evaluates citation rate on test_queries before and after optimization
evaluation:
  enable_citation: true   # Enable held-out (test_queries) citation evaluation
  enable_geo_score: false
  enable_similarity: false
